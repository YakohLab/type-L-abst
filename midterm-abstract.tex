\documentclass[twocolumn,9pt]{ltjsarticle}

\usepackage{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{mathtools}
	\mathtoolsset{showonlyrefs=true}
\usepackage{./midterm-abstract}
% Lualatexの処理系の問題で、siunitxを使う場合は\usepackage{./midterm-abstract}の後にusepackageする
\usepackage[detect-all]{siunitx}
\usepackage{tabularx}
\usepackage{mwe}
\usepackage{cleveref}
\renewcommand{\ref}{\Cref}

\def\thesisnumber{2019-16-02}
\title{マルチユーザ赤外線通信の設計}
\def\englishtitle{Designing a Multi-user Infrared Communication}
\author{81816518 鳥野見武家 (Takeie Torinomi)　Supervisor: 矢向高弘 (Takahiro Yakoh)}
\begin{document}
\maketitle
\section{Introduction}
One common lightwave telecommunication method is infrared, widely used in remote controllers for consumer electronics, and previously used as an intre-device communication.
Although, since infrared communication runs at a low modulation frequency of \SI{38}{kHz}, obtaining a compromisable data rate is a challenge.Ever since the improvement of radio frequency (RF) telecommunication, it has not drawn much attention.

Nonetheless, we argue that however it was impossible with any existing protocols, by carefully designing a new protocol, we can achieve a reasonable data rate, with multiuser characteristics.
Multiuser characteristics are essential when considering an open environment, where many terminals enter and leave the communication channel on the fly.

In this paper, we propose a tightly packed frame protocol, enabling multiuser access in an open environment.
Our system is implemented as a system on a chip (SoC), enabling us an appropriate balance of performance and flexibility.

\section{Conventional protocols}
%% TODO(me):Write something here

\subsection{Time division multiple access}
Time division multiple access (TDMA) is a protocol, which assignes ``time-slot'' exclusive to each terminal, along with a ``guard-time'' between each time slot to avoid overlapping of transmission, when two or more users have different propagation delays.
During the assigned time-slot, each terminal is allowed to do any kinds of operations.

However, since TDMA divides time, a synchronization between terminals is required.
Also, each terminal in TDMA must be pre-configured which time-slot to use, making it useless in open environments.

\subsection{Ethernet for Control Automation Technology}
Ethernet for Control Automation Technology (EtherCAT) is a protocol, where a network controller controls the whole network.
Data is interchanged by circulating frames transmitted by the controller in the network.
Only when a frame arrives, each terminal is allowed to read/write data.
After the node finished reading/writing, the frame is transmitted to the next node.
By preforming this read/write/transmit procedure are on-the-fly, high-speed and real-time communication is possible.

However, since each terminal in EtherCAT must be pre-configured, it is also useless in open environments.
Also, EtherCAT is a protocol for wired telecommunication, already requiring 

\section{Proposed protocol}
The protocol involves several terminals, which communicate simultaneously with each other in the network, and a central controller, to manage the network, as illustrated in \ref{fig:overview}.

\begin{figure}[tb]
  \centering
  \includegraphics[width=\linewidth]{overview-crop.pdf}
  \caption{\label{fig:overview}
    Illustration of proposed protocol's system.
  }
\end{figure}

Since we are dealing with open environments, each terminal joins/leaves the network, and connects/disconnects to another by sending requests to the controller.
A footer-like request section is used, where controller/terminals use to send/receive requests, defined in the request protocol.
The controller then processes requests and responds whether the request was accepted or not, along with additional information.
The protocol pre-define the requests as request protocols, as shown in \ref{tab:request}.

\begin{table}[tb]
  \centering
  \caption{\label{tab:request}
    Table of request protocols.
  }
  \begin{tabularx}{\linewidth}{ccl}
    \hline
    Identifier & Name & Description\\
    \hline \hline
    R & Register & Join network\\
    U & Unregister & Leave network\\
    D & Connect & Connect to another terminal\\
    H & Disconnect & Break current connection\\
    \hline
  \end{tabularx}
\end{table}

To achieve the specification, we use an especial frame structure, as shown in \ref{fig:frame}.
This frame is built from the controller and several terminals in the network on the fly, like EtherCAT.
By taking this method, we can relish the key features of EtherCAT; decreased delay, since each terminals do not have to process the entire frame to send its data.
Furthermore, unlike EtherCAT, where all terminals have to be connected in a daisy chain, our protocol is aimed for wireless fields, where connection is as easy as putting each terminal in range of controller.

Other than that, we have more advantages:
\begin{itemize}
\item Every block has no guard intervals; thus, data every block is entirely used as data.
\item The destination of each block is pre-defined by the network; thus, no extra headers/footers are needed for each block.
\end{itemize}

\begin{figure}[tb]
  \centering
  \includegraphics[width=\linewidth]{frame-crop.pdf}
  \caption{\label{fig:frame}
    Illustration of frame used in the protocol.
  }
\end{figure}

\subsection{Header}
The header consists of a single octet field, containing the number of connected terminals $n_{c}$ in the network.
Since each data block length, $l_d$ is fixed, and the number of data depends on the number of connected terminals, and request section is fixed length $l_r$, the frame length $L$ can be calculated by,
\begin{equation}
  \label{}
  L = n_c \cdot l_d \cdot 2 + l_r \cdot 2,
\end{equation}
which is used to detemine the end of the frame.

\subsection{Data}
The data consists of multiple four-octet blocks.
For each connected terminal in the network, the controller grants two data fields; one for the terminal to the controller (uplink) and the other for the controller to the terminal (downlink).
A four octet block is chosen since it can send one single-precision floating-point number, which the goal of this protocol is for motion controlling in open environments.

\subsection{Request}
The request consists of two double octet fields, each for uplink and downlink request.
This request field does every operation related to the network.
The operations are shown in \ref{tab:request}.

Only the controller performs downlink requests; however, many terminals make uplink requests, leading to collisions and unsuccessful uplink requests.

Each terminal solves this problem by performing a re-request after waiting a random amount of time.
\section{Implementation}
To satisfy the above-mentioned protocol, a System on a Chip (SoC) implementation, especially Zynq\textregistered -7000 SoC from Xilinx\textregistered, was chosen.

The controller and terminal is shown in \ref{fig:controller} and \ref{fig:terminal} respectivly.
Both the controller and terminal operates data by opening the data gate at the exact time.
Both operate with its oscillator; however, for terminals phase synchronisation is necessary.

\begin{figure}[tb]
  \centering
  \includegraphics[width=\linewidth]{NL-crop.pdf}
  \caption{\label{fig:controller}
    Illustration of controller.
  }
\end{figure}

\begin{figure}[tb]
  \centering
  \includegraphics[width=\linewidth]{UE-crop.pdf}
  \caption{\label{fig:terminal}
    Illustration of terminal.
  }
\end{figure}

The Processing System (ARM\textregistered -based processor) takes care of the received data, where for the controller and terminal are processed.
%% as \ref{fig:controller-proc} and \ref{fig:terminal-proc}, respectively.

\section{Evaluation}
Two elaluation was done to validate the protocol.
\begin{itemize}
\item \textbf{Evaluation 1}, validated the open enviroment performance of the protocol.
  Using two terminals and controller, we verified that two terminals registered to the network, provided by the controller.
  Upon un-registration, we also verified that the unused frames were released.
\item \textbf{Evaluation 2}, validated the multiuser performance of the protocol.
  Using two terminals registered to the network, we verified that two terminals could simultaneously send/receive datum.
\end{itemize}

\section{Conclusion}
This thesis presented a new protocol, based on TDMA and EtherCAT, aimed to enable multiuser telecommunication in an open environment with low symbol rate systems.
We introduced a central controller to enable multiuser specifications.
To maximise the bit efficiency, we removed the guard time and headers for each terminal.
To realise these specifications, we implemented the system to an SoC.
We validated the implementation and verified that the specifications meet the protocol specifications.
\end{document}
